sudo: enabled
os: linux
language: c

install:
- git clone https://github.com/cc65/cc65 /tmp/cc65 &&
  sudo make -C /tmp/cc65 ca65 ld65 avail &&
  ca65 --version
- git clone https://github.com/mach-kernel/cadius /tmp/cadius &&
  make -C /tmp/cadius &&
  sudo make -C /tmp/cadius install

script:
- bin/setlang en && make && make package
- bin/setlang fr && make && make package
- bin/setlang it && make && make package
- bin/setlang es && make && make package
- bin/setlang de && make && make package

deploy:
  provider: releases
  prerelease: true
  api_key:
    secure: GKESS8qxyVM+0LHVniDMIKLi3ACVXQnacUvzEb/Qn+1PEw6aJ43mv4CQ8E8WyDXSi6i0FXgf72ky+bqa5u/ziYLAwgbtyu3MibNYl2Ryx8B/jdUCQsUPPlf75uBRgQNPt8gj9oBfRFh5omhZdNRaX3VHCYqi1ZrbAO3e2nunhfwddwcMLjl8wnzaM1jdm46lfdvt++GeihqCycdKVOpc6GZQqwwVtrHt9315JCzPJ9BXALxaQL0QSCpJ5uQwVhTS0Sh/k+VqxZ/nUyJ5sqgOulBRHwE0bgqKPV6zrnqftCr1PNwRXkOJfY3eM7ZbWr/vH8TaKU/21fSOxr3NmK/mHqiDun5Sm4duIRl+fm9QAxH93uyxsqPeAmxxSfNnvq6G0k3zFXPiRVgy1ceSIvYFZyCjKQEg0FF+vup0NzP85k8TpX3G4CO/WTOwVvnXruomMO5XpR3bnF1TIffDkU4DGtSpCO7FXH/Kq/CVQw3k155DhXE3IsHCId3bxlFnP0YHk/MS6Unzmcc4DDQS8pIgQII7woMv3g8gYiRQvp4gHbNvDbVi0kyAlJYbQ9lvOWjoFYs+sfxKG6J7AgO4CJ0c10/GwitvzGw9CUeR2O2sgX3i4DUbQEDCKgOO8rj+DqNH70ZtwJZmGG1TZfv1Og+hdoz9rLaFXGw1iFJ5/OXsLK8=
  file_glob: true
  file:
    - $TRAVIS_BUILD_DIR/out/*.2mg
    - $TRAVIS_BUILD_DIR/out/*.po
    - $TRAVIS_BUILD_DIR/res/README.txt
  skip_cleanup: true
  on:
    repo: a2stuff/a2d
    tags: true
